{"ast":null,"code":"var _jsxFileName = \"/Users/draxzh/Documents/web project/sneaker_shopping/app/src/components/Products.js\";\nimport React from 'react';\nimport axios from 'axios';\nimport ToolBox from './ToolBox';\nimport Product from './Product';\nimport { CSSTransition, TransitionGroup } from 'react-transition-group';\nimport Panel from 'components/Panel';\nimport AddInventory from 'components/AddInventory';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass Products extends React.Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      products: [],\n      //搜素后products的值会被更改\n      sourceProducts: [],\n      cartNum: 0\n    };\n\n    this.search = text => {\n      //Get New Array\n      let _products = [...this.state.sourceProducts]; //Filter New Array\n\n      _products = _products.filter(p => {\n        //拿到name调用match方法\n        const matchArray = p.name.match(new RegExp(text, 'gi'));\n        return !!matchArray;\n      }); //set state\n\n      this.setState({\n        products: _products\n      });\n    };\n\n    this.toAdd = () => {\n      Panel.open({\n        component: AddInventory,\n        callback: data => {\n          console.log(data);\n\n          if (data) {\n            this.add(data);\n          }\n        }\n      });\n    };\n\n    this.add = product => {\n      const _products = [...this.state.products];\n\n      _products.push(product);\n\n      const _sProducts = [...this.state.sourceProducts];\n\n      _sProducts.push(product);\n\n      this.setState({\n        products: _products,\n        sourceProducts: _sProducts\n      });\n    };\n\n    this.update = product => {\n      const _products = [...this.state.products];\n\n      const index = _products.findIndex(p => p.id === product.id);\n\n      _products.splice(index, 1, product);\n\n      const _sProducts = [...this.state.sourceProducts];\n\n      const sourceIndex = _sProducts.findIndex(p => p.id === product.id);\n\n      _sProducts.splice(sourceIndex, 1, product);\n\n      this.setState({\n        products: _products,\n        sourceProducts: _sProducts\n      });\n    };\n\n    this.delete = id => {\n      const _products = this.state.products.filter(p => p.id !== id);\n\n      const _sProducts = this.state.sourceProducts.filter(p => p.id !== id);\n\n      this.setState({\n        products: _products,\n        sourceProducts: _sProducts\n      });\n    };\n\n    this.updateCartNum = async () => {\n      const cartNum = await this.initCartNum();\n      this.setState({\n        cartNum: cartNum\n      });\n    };\n\n    this.initCartNum = async () => {\n      const res = await axios.get('http://localhost:3003/carts');\n      const carts = res.data || [];\n      const cartNum = carts.map(cart => cart.mount).reduce((a, value) => a + value, 0);\n      return cartNum;\n    };\n  }\n\n  componentDidMount() {\n    axios.get('http://localhost:3003/products').then(response => {\n      this.setState({\n        products: response.data,\n        sourceProducts: response.data\n      });\n    });\n  } //search the products\n\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(ToolBox, {\n        search: this.search,\n        cartNum: this.state.cartNum\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"products\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"columns is-multiline is-dektop\",\n          children: /*#__PURE__*/_jsxDEV(TransitionGroup, {\n            component: null,\n            children: this.state.products.map(p => {\n              return /*#__PURE__*/_jsxDEV(CSSTransition, {\n                classNames: \"product-fade\",\n                timeout: 300,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"column is-3\",\n                  children: /*#__PURE__*/_jsxDEV(Product, {\n                    product: p,\n                    update: this.update,\n                    delete: this.delete,\n                    updateCartNum: this.updateCartNum\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 114,\n                    columnNumber: 41\n                  }, this)\n                }, p.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 113,\n                  columnNumber: 37\n                }, this)\n              }, p.id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 112,\n                columnNumber: 37\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"button is-primary add-btn\",\n          onClick: this.toAdd,\n          children: \"ADD\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default Products;","map":{"version":3,"sources":["/Users/draxzh/Documents/web project/sneaker_shopping/app/src/components/Products.js"],"names":["React","axios","ToolBox","Product","CSSTransition","TransitionGroup","Panel","AddInventory","Products","Component","state","products","sourceProducts","cartNum","search","text","_products","filter","p","matchArray","name","match","RegExp","setState","toAdd","open","component","callback","data","console","log","add","product","push","_sProducts","update","index","findIndex","id","splice","sourceIndex","delete","updateCartNum","initCartNum","res","get","carts","map","cart","mount","reduce","a","value","componentDidMount","then","response","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport ToolBox from './ToolBox';\nimport Product from './Product';\nimport { CSSTransition, TransitionGroup } from 'react-transition-group';\nimport Panel from 'components/Panel';\nimport AddInventory from 'components/AddInventory';\n\nclass Products extends React.Component{\n    state = {\n        products:[],\n        //搜素后products的值会被更改\n        sourceProducts:[],\n        cartNum: 0\n    };\n\n    componentDidMount(){\n        axios.get('http://localhost:3003/products').then(response=>{\n            this.setState({\n                products:response.data,\n                sourceProducts: response.data\n            });\n        });\n    }\n    //search the products\n    search = text =>{\n        //Get New Array\n        let _products = [...this.state.sourceProducts]\n        //Filter New Array\n        _products = _products.filter(p=>{\n            //拿到name调用match方法\n            const matchArray =  p.name.match(new RegExp(text, 'gi'));\n            return !!matchArray;\n        })\n        //set state\n        this.setState({\n            products: _products\n        })\n    }\n    \n    toAdd=()=>{\n        Panel.open({\n            component: AddInventory,\n            callback: data =>{\n                console.log(data);\n                if(data){\n                    this.add(data);\n                }\n            }\n        });\n    }\n\n    add = product =>{\n        const _products = [...this.state.products];\n        _products.push(product);\n        const _sProducts = [...this.state.sourceProducts];\n        _sProducts.push(product)\n\n        this.setState({\n            products:_products,\n            sourceProducts:_sProducts\n        })\n    }\n\n    update = product =>{\n        const _products = [...this.state.products];\n        const index = _products.findIndex(p=>p.id === product.id);\n        _products.splice(index, 1, product);\n        const _sProducts = [...this.state.sourceProducts];\n        const sourceIndex = _sProducts.findIndex(p => p.id === product.id);\n        _sProducts.splice(sourceIndex, 1, product);\n        this.setState({\n            products: _products,\n            sourceProducts: _sProducts\n        })\n    }\n\n    delete = id =>{\n        const _products = this.state.products.filter(p=>p.id !== id);\n        const _sProducts = this.state.sourceProducts.filter(p => p.id !== id)\n        this.setState({\n            products:_products,\n            sourceProducts : _sProducts\n        });\n    }\n\n    updateCartNum = async () => {\n        const cartNum = await this.initCartNum();\n        this.setState({\n            cartNum: cartNum\n        });\n    }\n\n    initCartNum = async () => {\n        const res = await axios.get('http://localhost:3003/carts');\n        const carts = res.data || [];\n        const cartNum = carts.map(cart => cart.mount).reduce((a, value) => a + value, 0);\n        return cartNum;\n    };\n \n\n    render(){\n        return(\n            <div>\n                <ToolBox search={this.search} cartNum={this.state.cartNum}/>\n                <div className=\"products\">\n                    <div className=\"columns is-multiline is-dektop\">\n                        <TransitionGroup component = {null}>\n                        {\n                            this.state.products.map(p=>{\n                                return(\n                                    <CSSTransition classNames=\"product-fade\" timeout ={300} key={p.id}>\n                                    <div className=\"column is-3\" key={p.id}>\n                                        <Product product={p} update={this.update} delete={this.delete} updateCartNum={this.updateCartNum}/>\n                                    </div>\n                                    </CSSTransition>\n                                );\n                            })\n                        }\n                        </TransitionGroup>\n                    </div>\n                    <button className=\"button is-primary add-btn\" onClick={this.toAdd}>ADD</button>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default Products;"]},"metadata":{},"sourceType":"module"}